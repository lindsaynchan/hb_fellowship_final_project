{% extends 'base.html' %}
{% block title %}Series!{% endblock %}
{% block header %}
<script src="/static/showpage.js"></script>
{% endblock %}
{% block content %}

<h1>{{ show_info.title }}</h1>

<div><img src="{{ show_info.artwork_urls }}"></div>

<br><br>

{% if "current_user" in session %}
<button class="favorite-btn" id="{{ show_info.guidebox_id }}">
    {% if favorited %}
    &#10003; 
    {% endif %}
    Favorite</button>
{% endif %}

<br><br>
<script>var guidebox_id={{ show_info.guidebox_id }};</script>
{% raw %}
<div ng-app="showInformation">
    <ul class="nav navbar-nav">
        <li><a href="#/show_info">Info</a></li>
        <li><a href="#/streaming">Streaming</a></li>
        <li><a href="#/tv_listing">TV Listings</a></li>
    </ul>
    <div class="container">
        <div class="row">
            <div class="col-xs-12">

                <div ng-view></div>

            </div>
        </div>
    </div>
</div>
{% endraw %}
<script>

    //when the favorite button is clicked, submit post request to add/delete from favorites table
    function addToFavoritesList(evt) {
        var id = this.id;
        var buttonContent = $('.favorite-btn').html()
        $.post('/save_to_favorites', {'id': id, 'button_content':buttonContent}, changeButtonStatus);
    
    }

    //receiving the information from the server to determine whether the favorite button has a checkmark or not
    function changeButtonStatus(result) {
        var id = result["show_id"];
        if (result["favorite"] == "True") {
            $('#' + id).html('&#10003; Favorite');
        }
        else {
            $('#' + id).html('Favorite');
        }    
    }

    //event listener on the favorite button
    $('.favorite-btn').click(addToFavoritesList);

    $('#myTabs a').click(function (e) {
        e.preventDefault();
        $(this).tab('show');
    });

</script>

{% endblock %}
</html>





